<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>

    
    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src="https://rawgit.com/moment/moment/2.2.1/min/moment.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poller+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>Weather Dashboard</header>
    <div>

        <aside id="city-search" class="card" style="width: 18rem;">
            <p>Search for a City:</p>
            <div>
                <input id="cityName" type="text" placeholder="Search.." name="search">
                <button id="search-btn" type="submit"><i class="fa fa-search"></i></button>
            </div>
            <br>
            <ul class="list-group">
                <li class="list-group-item">Dapibus ac facilisis in</li>
                <li class="list-group-item">Morbi leo risus</li>
                <li class="list-group-item">Porta ac consectetur ac</li>
                <li class="list-group-item">Vestibulum at eros</li>
              </ul>
        </aside>
        <section>
            <div id="weather">
                <h3 id=currentCity>placeholder text</h3>
            </div> 
            <div id="forecast">
                <h4>5-Day Forecast:</h4>
                <img src="https://via.placeholder.com/150">
                <img src="https://via.placeholder.com/150">
                <img src="https://via.placeholder.com/150">
                <img src="https://via.placeholder.com/150">
                <img src="https://via.placeholder.com/150">
            </div>
        </section>
    </div>
    
    <script>
        
        
        $("#search-btn").on("click", function(){
            cityName = $("#cityName").val().trim();
        

            APIkey = "0e6e51c7b5cd8f3a0f8ccffef0a8bb5b"
            queryURL = "http://api.openweathermap.org/data/2.5/weather?q=" + cityName + "&appid=" + APIkey
            
            $.ajax({
                method: "GET",
                url: queryURL,
            }).then(function(response) {
                console.log(response);
                $("#weather").empty();
                //Create a div for the city name and current date to display
                cityName = (response.name);
                currentDate = moment().format('l'); 
                nameDiv = $("<h3>");
                nameDiv.append(cityName + " (" + currentDate + ")");
                $("#weather").prepend(nameDiv);
                //Add icon after date
                weatherIcon = (response.weather[0].icon);
                iconURL = "http://openweathermap.org/img/w/" + weatherIcon + ".png";
                console.log(iconURL);
                weatherEl = $("<img>");
                weatherEl.attr("src", iconURL);
                nameDiv.append(weatherEl);
                //Create a div for the temperature to display
                tempF = ((response.main.temp - 273.15) * 1.8) + 32;
                temp = tempF.toFixed(1);
                tempDiv = $("<div>");
                tempDiv.append("Temperature: " + temp + " &#8457;");
                $("#weather").append(tempDiv);
                //Create a div for the humidity
                humidity = (response.main.humidity);
                humidDiv = $("<div>");
                humidDiv.append("Humidity: " + humidity + "&#37;");
                $("#weather").append(humidDiv);
                //Create a div for the wind speed
                windSpeed = (response.wind.speed);
                windDiv = $("<div>");
                windSpeed = (windSpeed * 2.237).toFixed(1);
                windDiv.append("Wind speed: " + windSpeed + " MPH");
                $("#weather").append(windDiv);

            //Second ajax call for additional OpenWeather API
            APIkey = "0e6e51c7b5cd8f3a0f8ccffef0a8bb5b"
            lat = (response.coord.lat)
            lon = (response.coord.lon)
            queryURL = "http://api.openweathermap.org/data/2.5/uvi?lat=" + lat + "&lon=" + lon + "&appid=" + APIkey
            
            $.ajax({
                method: "GET",
                url: queryURL,
            }).then(function(response) {
               UVindex = (response.value)
               uvDiv = $("<div>");
               uvDiv.html("UV Index: " + "<span>" + UVindex + "</span>");
               $("#weather").append(uvDiv);
               })
            //Third ajax call for 5 day forecast from OpenWeather API
            APIkey = "0e6e51c7b5cd8f3a0f8ccffef0a8bb5b"
            queryURL = "http://api.openweathermap.org/data/2.5/forecast?q=" + cityName + "&appid=" + APIkey
            
            $.ajax({
                method: "GET",
                url: queryURL,
            }).then(function(response) {
               
               })
            }
            )});
    </script>
    
</body>
</html>